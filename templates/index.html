<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>YouTube Video Downloader</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
  <form id="url-form">
    <label for="url">Video URL:</label>
    <input type="text" id="url" name="url" placeholder="Enter YouTube video URL">
    <button id="fetch-formats" type="button">Fetch Formats</button>
  </form>
  <div id="formats-list"></div>
  <button id="download" type="button" disabled>Download</button>

  <script type="text/javascript">
    $(document).ready(function() {
      $('#fetch-formats').click(function() {
        var url = $('#url').val();
        $.ajax({
          type: 'POST',
          url: '/formats',
          data: { url: url },
          success: function(response) {
            $('#formats-list').empty();
            var formats = response.formats;
            $.each(formats, function(i, format) {
              $('#formats-list').append($('<option>', {
                value: format.itag,
                text: format.resolution + ' - ' + format.mime_type
              }));
            });
            $('#download').prop('disabled', false);
          },
          error: function(error) {
            console.log(error);
          }
        });
      });

      $('#download').click(function() {
        var url = $('#url').val();
        var format = $('#formats-list').val();
        window.location.href = '/download?url=' + encodeURIComponent(url) + '&format=' + encodeURIComponent(format);
      });
    });
  </script>
</body>
</html>